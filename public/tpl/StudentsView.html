<legend>Alunos</legend>
<br/>

<div class="row">
  <div class="col-lg-5">
    <div class="input-group">
      <input type="text" id="txtPesquisa" class="form-control" maxlength="100">
      <div class="input-group-btn">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Por Nome <span class="caret"></span></button>
        <ul class="dropdown-menu pull-right">
          <li><a onclick="find('name');">Por Nome</a></li>
          <li><a onclick="find('cpf');">Por CPF</a></li>
          <li><a onclick="find('registration');">Por Matrícula</a></li>
          <li><a onclick="find('limpar');">Limpar Pesquisa</a></li>
        </ul>
      </div><!-- /btn-group -->
    </div><!-- /input-group -->
  </div><!-- /.col-lg-6 -->
<button class="btn btn-primary btn-large">Incluir Aluno</button>
</div><!-- /.row -->


<br/>

<div class="row">
    <div id="divStudents" class="col-md12">
        <table id="tbStudents" class="table table-hover">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Matricula</th>
                    <th>CPF</th>
                    <th>Data Inclusão</th>
                    <th>Ativo</th>
                 </tr>
             </thead>            <tbody>
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<form class="form-horizontal span12">

    <div id="addAccount" class="modal container hide fade" tabindex="-1">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3>Gerar senha de acesso</h3>
    <div id="addAccountAlert" class="alert alert-warning" style="text-align: center">
            <b>Este usuário já possui senha de acesso</b>
        </div>
  </div>
  <fieldset>
  <div class="modal-body">
    <section style="float: left; width: 48%">
                    <div class="control-group">
                        <label for="name" class="control-label">Email:</label>

                        <div class="controls">
                            <input type="text" class="form-control" id="username" name="username" maxlength="100" readonly style="float: left"/>
                            <span class="help-inline"></span>
                        </div>
                    </div>
                    <section>
                    <article style="float: left; width: 48%; padding: 5px 0px;">
                    <div class="control-group">
                        <label for="grapes" class="control-label">Senha:</label>

                        <div class="controls">
                            <input type="text" class="form-control" id="password" name="password" maxlength="100"/>
                            <span class="help-inline"></span>
                        </div>
                    </div>
                    </article>
                    <article style="float: right; width: 48%; padding: 5px 0px;">
                    <div class="control-group">
                        <label for="grapes" class="control-label">Confirma Senha:</label>

                        <div class="controls">
                            <input type="text" class="form-control" id="passwordconfirm" name="passwordconfirm"/>
                            <span class="help-inline"></span>
                        </div>
                    </div>
                    </article>
                    </section>
    </section>
  </div>
  </fieldset>
  <br/>
  <div class="modal-footer">
    <button type="button" data-dismiss="modal" class="btn">Cancelar</button>
    <button type="button" class="btn btn-primary btn-large save">Gerar Senha de Acesso</button>
  </div>
  <br/>
</div>
</form>

<script>
    function find(por) {
        
        var pesquisa = $('#txtPesquisa').val();


        if (por == 'limpar')
            window.location = '#students';

        if (pesquisa.length == 0)
            return;

        window.location = '#students/' + por + '/' + $('#txtPesquisa').val();
    }

    $(document).on("click", ".openAddAccount", function () {
        var username = $(this).data('id');



        $("#addAccountAlert").hide();
        $(".modal-body #username").val(username);

        $.getJSON('/account/' + username, function (data) {
            if(data)
            $("#addAccountAlert").show();
        });




        // As pointed out in comments, 
        // it is superfluous to have to manually call the modal.
        // $('#addBookDialog').modal('show');
    });


    // Account
    function AccountData(fusername, fpassword) {
        this.fusername = fusername;
        this.fpassword = fpassword;
        this.toJsonString = function () { return JSON.stringify(this); };

    };

    $(document).on("click", ".save", function () {
        alet('ok');
        var username = $(".modal-body #username").val();
        var accountData = AccountData($(".modal-body #username").val(), $(".modal-body #password").val());

        jQuery.ajax({
            type: "PUT",
            url: '/account/' + username,
            contentType: "application/json; charset=utf-8",
            data: accountData.toJsonString(),
            dataType: "json",
            success: function (data, status, jqXHR) {
                alert('success');
            },

            error: function (jqXHR, status) {
                alert('error');

            }
        });
    };

</script>